document.addEventListener("DOMContentLoaded",(function(){const e="mauticform_formulariowebeva",t="mauticform_input_formulariowebeva",n="https://api.halsystem.es/v1",l="7f140b80f23dc86f95182614da4b6b53",d=(e,t)=>{let n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let t=JSON.parse(this.responseText);document.getElementById(e).innerHTML=t}},n.open("GET",t,!0),n.send()},i=(n,l)=>{let d=document.getElementById(e+"_"+n);if(!d)return;document.getElementById(t+"_"+n).remove();let i=document.createElement("input");i.id=t+"_"+n,i.name="mauticform["+n+"]",i.setAttribute("value",l),d.appendChild(i),d.style.display="none"},a=()=>{let e=document.getElementById("id-clinic");if(e){let t=e.getAttribute("data-id-clinic");i("id_clinic",t)}else((e=0)=>{let i=n+"/clinics/for-select?area=1&access-token="+l+"&pageSize=10000&select=true";0!=e&&(i+="&region="+e);let a=c();a.utmClinics&&(i+=`&clinics=${a.utmClinics}`),d(t+"_id_clinic",i),o(0)})()},c=()=>{let e=new URLSearchParams(location.search);return{utmClinics:e.get("utm_clinics"),utmCR:e.get("utm_cr")}},o=e=>{0==e&&(document.getElementById(t+"_time_select").innerHTML='<option value="">Selecciona la hora</option><option disabled selected value>No hay horas disponibles</option>'),0!=e&&1!=e||(document.getElementById(t+"_date").innerHTML="--/--/----"),document.getElementById(t+"_pv_date_time").value=""},m=()=>{document.getElementById(t+"_submit").click()},s=e=>{if(e)m();else{let e=!1,n=document.getElementById(t+"_time_select"),l=document.getElementById(t+"_date");console.info(n.value),console.info(l.value),""==n.value&&(alert("Falta elegir una hora"),e=!0),""==l.value&&(alert("Falta elegir una fecha"),e=!0),e||m()}},u=()=>{document.getElementById(e+"_date").style.display="none",document.getElementById(e+"_time_select").style.display="none",document.getElementById(e+"_submit").style.display="none",document.getElementById("btnSend").style.display="block",document.getElementById("boxBtnDateTime").style.display="none",document.getElementById("btnSelectDateTime").innerHTML="Seleccionar fecha"},r=()=>{let e=document.getElementById(t+"_id_consultation_reason");e&&e.addEventListener("change",(function(){var e=document.getElementById(t+"_id_clinic");""!==this.value&&189==this.value?(y(e,90,"Banco Madrid"),g()):(_(e,90),a(),p())}))},y=(e,t,n)=>{let l=document.createElement("option");l.value=t,l.text=n,e.appendChild(l),e.value=t,e.style.display="none"},_=(e,t)=>{let n=e.querySelector('option[value="'+t+'"]');e.removeChild(n),e.value="",e.style.display="block"},g=()=>{let t=document.getElementById(e+"_id_consultation_reason"),n=document.createElement("h5");n.id="alert-clinic",n.textContent="Servicio exclusivo para la clínica situada en C/ Villa de Marín, 7 (Madrid)",t.appendChild(n)},p=()=>{let e=document.getElementById("alert-clinic");e&&e.remove()};(()=>{(()=>{let e=document.getElementById("id-consultation");if(e){let t=e.getAttribute("data-id-consultation");t>0&&i("id_consultation_reason",t)}else d(t+"_id_consultation_reason",n+"/consultation-reasons/group?id=13&select=true&access-token="+l+"&pageSize=10000&select=true")})(),a(),(()=>{document.getElementById(e+"_subscribe");let t=document.getElementById("tdBtnSend");const n=document.createElement("button");n.style.width="100%",n.id="btnSend",n.type="button",n.innerText="Solicitar cita",t.appendChild(n),n.addEventListener("click",(e=>{s(!0)}));let l=document.getElementById("tdBtnSelect");const d=document.createElement("button");d.style.width="100%",d.type="button",d.id="btnSelectDateTime",d.innerText="Seleccionar fecha y hora",l.appendChild(d),d.addEventListener("click",(t=>{"block"==document.getElementById(e+"_date").style.display?u():(document.getElementById(e+"_date").style.display="block",document.getElementById(e+"_time_select").style.display="block",document.getElementById("boxBtnDateTime").style.display="block",document.getElementById("btnSend").style.display="none",document.getElementById("btnSelectDateTime").innerHTML="Ocultar fecha")}));let i=document.getElementById("boxBtnDateTime");i.innerHTML="";const a=document.createElement("button");a.type="button",a.innerText="Pedir cita",i.appendChild(a),a.addEventListener("click",(e=>{s(!1)}))})(),u();let c=document.getElementById(t+"_time_select"),o=document.getElementById(t+"_date"),m=document.getElementById(t+"_pv_date_time");c.addEventListener("change",(e=>{let t=c.options[c.selectedIndex].text;m.value=o.value+" "+t}),!1),o.addEventListener("change",(e=>{(e=>{let i=(e=>{let t=e.getDate();t<10&&(t="0"+t);let n=e.getMonth()+1;return n<10&&(n="0"+n),t+"-"+n+"-"+e.getFullYear()})(new Date(e.target.value)),a=document.getElementById(t+"_id_clinic").value;a?d(t+"_time_select",n+"/events/free-slots?id_clinic="+a+"&access-token="+l+"&pageSize=10000&select=true&date_start="+i+"&id_area=1"):(alert("Primero debes seleccionar una clínica"),document.getElementById(t+"_date").value="")})(e)}),!1),r()})(),o(0)}));